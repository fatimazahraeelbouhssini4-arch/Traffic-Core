# === Minimum & projet ===
cmake_minimum_required(VERSION 3.15)
project(SmartBoukhalf VERSION 1.0 LANGUAGES CXX)

set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)
set(CMAKE_CXX_EXTENSIONS OFF)

# === Options compilation ===
if(MSVC)
    add_compile_options(/W4)
else()
    add_compile_options(-Wall -Wextra -Wpedantic)
endif()

# === Raylib ===
find_package(raylib 4.5 QUIET)
if(NOT raylib_FOUND)
    include(FetchContent)
    FetchContent_Declare(
        raylib
        GIT_REPOSITORY https://github.com/raysan5/raylib.git
        GIT_TAG 4.5.0
    )
    FetchContent_MakeAvailable(raylib)
endif()

# === Sources ===
set(GEOMETRY_SOURCES
    src/geometry/StraightGeometry.cpp
    src/geometry/CurvedGeometry.cpp
    src/geometry/RoundaboutGeometry.cpp
)

set(NETWORK_SOURCES
    src/Node.cpp
    src/RoadSegment.cpp
    src/Intersection.cpp
    src/RoadNetwork.cpp
)

# === Ex√©cutable principal ===
add_executable(smart_boukhalf
    demos/test_roads.cpp  # <-- ton main
    ${GEOMETRY_SOURCES}
    ${NETWORK_SOURCES}
)

# === Includes ===
target_include_directories(smart_boukhalf PRIVATE
    ${CMAKE_SOURCE_DIR}/include
    ${CMAKE_SOURCE_DIR}/include/geometry
)

# === Librairies ===
target_link_libraries(smart_boukhalf PRIVATE raylib)

if(WIN32)
    target_link_libraries(smart_boukhalf PRIVATE winmm)
elseif(UNIX AND NOT APPLE)
    find_package(X11 REQUIRED)
    target_link_libraries(smart_boukhalf PRIVATE m pthread dl rt X11)
endif()
